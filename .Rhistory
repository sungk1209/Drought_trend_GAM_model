geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.5, alpha = 0.7) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.2) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.7) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.2) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.7) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.6) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.7) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.6, alpha = 0.9) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.9, alpha = 0.6) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.6, alpha = 0.7) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.6) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.4, alpha = 0.7) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.6) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.4, alpha = 0.7) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 17),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
ggsave(filename = paste0(output.p,"/LT.png"),plot = p, width =6, height = 10, dpi = 300)
ggsave(filename = paste0(output.p,"/LT.svg"),plot = p, width =6, height = 10, dpi = 300)
j <- 11
loc <- site_list[[j]]
dir.create(file.path(output_path,loc$site[1]), recursive = FALSE)
output.p <- file.path(output_path, loc$site[1])
prcp_pos<- readRDS(file = paste0(output.p,"/prcp_df.rds"))
modeled_df<- readRDS(file = paste0(output.p,"/modeled_df.rds"))
plot_ms <- c(1,4,7,10)
colours = c("naspa" = "green4", "cru" = "#1A3FD4", "gridmet" = "orangered3")
supp.labs <- c("NDJ","FMA","MJJ","ASO")
names(supp.labs) <- plot_ms
#for (i in 1:length(plot_ms)) {
plotm <- plot_ms
p <- ggplot(data= modeled_df %>% filter(year > 1400 & month %in% plotm),
aes(x = year, y = modGI, group = plot_model)) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lowp, ymax = upp), alpha = 0.3) +
geom_ribbon(data = modeled_df%>% filter(year > 1400 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
geom_line(data= prcp_pos%>% filter(year > 1400 & month %in% plotm) ,
aes(y = precip, group = model, colour = model), size = 0.7, alpha = 0.6) +
geom_line(aes(color = "Modeled Trend"), color = "black",size = 1.4, alpha = 0.7) +
scale_fill_manual() +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1400, NA)) +
scale_y_continuous(expand= c(0,0), limits = c(0, NA)) +
facet_wrap(~month, ncol = 1,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 17),
strip.text = element_blank(),
#strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
strip.background = element_blank(),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
ggsave(filename = paste0(output.p,"/LT.png"),plot = p, width =6, height = 10, dpi = 300)
ggsave(filename = paste0(output.p,"/LT.svg"),plot = p, width =6, height = 10, dpi = 300)
require(lubridate)
require(tidyverse)
require(dplyr)
require(ncdf4)
require(fitdistrplus)
require(zoo)
library(RANN)
data_path <- "../data/"
output_path <- "../output"
select <- dplyr::select
site_list <- list()
site_list[1] <-list(data.frame(site="Okc_OK",
lon=c(-98,-97.5),
lat= c(35.0,35.5)))
site_list[2] <-list(data.frame(site="Phx_AZ",
lon= c(-112.5,-112.0),
lat=c(33.50,34.00)))
site_list[3] <- list(data.frame(site="Den_CO",
lon= c(-105.0,-104.5),
lat=c(39.50,40.00)))
site_list[4] <- list(data.frame(site="Aber_WA",
lon= c(-124.0,-123.5),
lat=c(46.50,47.00)))
site_list[5] <- list(data.frame(site="Alb_GA",
lon= c(-84.5,-84.0),
lat=c(31.50,32.00)))
site_list[6] <- list(data.frame(site="Mrv_OH",
lon= c(-83.5,-83.0),
lat=c(40.00,40.50)))
site_list[7] <- list(data.frame(site="Mor_MN",
lon= c(-96.0,-95.5),
lat=c(45.50,46.00)))
site_list[8] <- list(data.frame(site="Nyc_NY",
lon= c(-74.5,-74.0),
lat=c(40.50,41.00)))
site_list[9] <- list(data.frame(site="Los_CA",
lon= c(-118.5,-118.0),
lat=c(34.00,34.50)))
site_list[10] <- list(data.frame(site="Wax_TX",
lon= c(-97.0,-96.5),
lat=c(32.00,32.50)))
site_list[11] <- list(data.frame(site="SJn_CO",
lon= c(-106.5,-106.0),
lat=c(37.50,38.00)))
site_list[12] <- list(data.frame(site="Cwa_NC",
lon= c(-79.0,-78.5),
lat=c(33.50,34.00)))
site_list[13] <- list(data.frame(site="Grd_MT",
lon= c(-111,-110.5),
lat=c(44.5,45.00)))
site_list[14] <- list(data.frame(site="Roe_NM",
lon= c(-109,-108.5),
lat=c(31.0,31.50)))
loc <- site_list[[j]]
dir.create(file.path(output_path,loc$site[1]), recursive = FALSE)
output.p <- file.path(output_path, loc$site[1])
require(lubridate)
require(tidyverse)
require(dplyr)
require(ncdf4)
require(fitdistrplus)
require(zoo)
library(RANN)
select <- dplyr::select
data_path <- "../data"
output_path <- "../output"
j <-4
site_list[4] <- list(data.frame(site="Aber_WA",
lon= c(-124.0,-123.5),
lat=c(46.50,47.00)))
loc <- site_list[[j]]
dir.create(file.path(output_path,loc$site[1]), recursive = FALSE)
output.p <- file.path(output_path, loc$site[1])
gpcc_df <- readRDS(file = paste0(output.p,"/gpcc_df.rds"))
naspa_spi3<- readRDS(file = paste0(output.p,"/naspa_spi3.rds"))
paras<- gpcc_df %>% select(date,shape3, rate3) %>%
group_by(month(date)) %>%
summarise(shape = mean(shape3), rate = mean(rate3)) %>%
rename(month =`month(date)`)
n_library <- length(gpcc_df$precip)
### Convert library into a dataframe
library_df <- data.frame(i = seq(1,n_library), spi_thisjuly = as.numeric(gpcc_df$spi3)) %>%
mutate(spi_nextmay = dplyr::lead(gpcc_df$spi5, n=9,  default = NA))%>%
mutate(spi_nextjuly = dplyr::lead(gpcc_df$spi3, n=12,  default = NA))%>%
drop_na()
#library_df[1:50,]
library_df <- library_df %>% select(-i)
n_neighbors <- 10
begin.y <- yrs[[1]][1]
end.y <- yrs[[2]][1] -1
n_neighbors <- 10
head(gpcc_df)
head(naspa_spi3)
date_subset <- seq(as.Date(paste0(year_i,"-08-01")),
as.Date(paste0(year_i+1,"-08-01")),
by = "month")-1
naspa_subset <- naspa_spi3 %>%
filter(date %in% date_subset)
naspa_points <- data.frame(spi_thisjuly = naspa_subset$spi3[[1]],
spi_nextapr = naspa_subset$spi5[[10]],
spi_nextjuly = naspa_subset$spi3[[13]])
n_neighbors <- 10
head(naspa_points)
head(naspa_spi3)
bein.y <- 0
tail(naspa_spi3)
end.y <- 2015
###########################################################
###                     plotting                      #####
###########################################################
predicted_df <- readRDS(paste0(output.p,"downscaled_preip.rds"))
temp <- gpcc_df %>%
mutate(iter = "GPCC") %>%
mutate(year = year(date)) %>%
mutate(month = month(date)) %>%
select(year,month,spi3,date, iter,spi5)
temp2<- predicted_df %>%
select(year,month,spi3,date, iter,spi5)
naspa_temp <- naspa_spi3 %>%
mutate(iter = "naspa")
temp3 <- rbind(temp, temp2, naspa_temp)
p <-ggplot(temp3 %>%filter(year >1901 & month == 7), aes(x=date, y=spi3)) +
geom_line(aes(group = iter, colour= "grey")) +
geom_line(data = temp3 %>% filter(iter == "GPCC") %>%
filter(year >1901 & month == 7), size =1) +
geom_line(data = temp3 %>% filter(iter == "naspa") %>%
filter(year >1901 & month == 7), size =1,aes(color =  "red")) +
labs(title = paste0("")) +
coord_cartesian(ylim = c(-2.5,2.5)) +
theme_classic(base_size = 18)
p
p <-ggplot(predicted_df %>% filter(year(date) > 2000 & year(date) < 2010),
aes(x=date, y=spi3)) +
geom_line(aes(group = iter, color = 'grey')) +
geom_line(data = gpcc_df %>% filter(year(date) > 2000 & year(date) < 2010),
aes(y = spi3), color = "blue" ) +
labs(title = paste0("1900 - 1930",loc$site),
color = "data")
p
fyear <- 1950
fdate<- seq(as.Date(paste0(fyear,"-08-01")),
as.Date(paste0(fyear+1,"-08-01")),
by = "month")-1
fd_lab<- seq(as.Date(paste0(fyear,"-08-01")),
as.Date(paste0(fyear+1,"-08-01")),
by = "2 months")-1
p <-ggplot(predicted_df %>% filter(date %in% fdate),
aes(x=date, y= precip)) +
geom_line(aes(group = iter, color = "10NNs")) +
geom_line(data = gpcc_df %>% filter(date %in% fdate),
aes(x = date, y = precip, color = "GPCC"),size = 1.2, linetype = "dashed") +
stat_summary(aes(y = precip), fun = "mean", size = 1.2, geom = "line", na.rm = TRUE) +
labs(title = paste0(loc$site[1],fyear),
y = "3-months Prcp.(mm/Month)",
X = "Month",
color = "data") +
# scale_x_date(date_breaks = "2 months", date_minor_breaks = "months", date_labels = "%b") +
scale_x_date(breaks = fd_lab, date_labels = "%b") +
#scale_y_continuous(limits = c(0,400)) +
scale_color_discrete() +
theme_classic(base_size = 18)
p
p <-ggplot(predicted_df %>% filter(year(date) %in% fyear),
aes(x=date)) +
geom_line(aes(y = precip, group = iter, color = iter, alpha = 0.6), size = 0.8) +
geom_line(data = gpcc_df %>% filter(year(date) %in% fyear),
aes(x = date, y = precip, color = "GPCC") ) +
scale_color_manual(values = c("orangered2",rep("grey76",10))) +
labs(title = paste0("3months ave.mean and all NNs"),
y = "3-months Prcp.(mm/month)") +
theme_classic(base_size = 12)
p <- p + stat_summary(aes(y = precip),fun = "mean", colour = "green4", geom = "line")
p
p <-ggplot(predicted_df %>% filter(date %in% fdate),
aes(x=date, y= precip)) +
geom_line(aes(group = iter, color = "10NNs")) +
geom_line(data = gpcc_df %>% filter(date %in% fdate),
aes(x = date, y = precip, color = "GPCC"),size = 1.2, linetype = "dashed") +
stat_summary(aes(y = precip), fun = "mean", size = 1.2, geom = "line", na.rm = TRUE) +
labs(title = paste0(loc$site[1],fyear),
y = "3-months Prcp.(mm/Month)",
X = "Month",
color = "data") +
# scale_x_date(date_breaks = "2 months", date_minor_breaks = "months", date_labels = "%b") +
scale_x_date(breaks = fd_lab, date_labels = "%b") +
#scale_y_continuous(limits = c(0,400)) +
scale_color_discrete() +
theme_classic(base_size = 18)
p
ggsave(p,filename = paste0(output.p,"/",fyear,"_ds.png"),width = 6, height = 4 )
ggsave(p,filename = paste0(output.p,"/",fyear,"_ds.svg"),width = 6, height = 4 )
ggsave(p,filename = paste0(output.p,"/",fyear,"_ds.png"),width = 6, height = 4 )
ggsave(p,filename = paste0(output.p,"/",fyear,"_ds.svg"),width = 6, height = 4 )
output.p
i <- 1500
24 * 1225
j
output.p
#}
plotm <- plot_ms
p <- ggplot(data= modeled_df %>% filter(year > 1875 & month %in% plotm),
aes(x = year, y = modGI, group = model)) +
geom_line(aes(color = model), size = 1.2) +
geom_line(data= prcp_pos %>% filter(year > 1875 & month %in% plotm),
aes(y = precip, group = model, colour = model), size = 0.5, alpha = 0.7) +
geom_ribbon(data = modeled_df %>% filter(year > 1875 & month %in% plotm),
aes(ymin= lowp, ymax = upp, group = model,fill = model), alpha = 0.25) +
geom_ribbon(data = modeled_df %>% filter(year > 1875 & month %in% plotm),
aes(ymin= lower,ymax= upper), alpha = 0.25, fill = "grey") +
scale_fill_manual(values = colours) +
scale_colour_manual(values = colours) +
scale_x_continuous(expand= c(0,0), limits = c(1875, NA)) +
facet_wrap(~month, ncol = 2,
labeller = labeller(month = supp.labs)) +
labs(#title = paste(plotm,loc$site[1]),
y="3-Month ave.prcp(mm/Month)",
color ='datasets')+
theme(text = element_text(colour = 'black',size = 20),
strip.text = element_text(colour = 'black',size =15),
axis.ticks.length=unit(0.3, "lines"),
panel.border = element_rect(fill = NA, color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
p <- ggplot(data= modeled_df %>% filter(month %in% plotm),
aes(x = year, y = modGI)) +
geom_line(aes(group = month, color = month), size = 0.6) +
#geom_ribbon(data = modeled_df %>% filter(month %in% plotm),
#            aes(ymin = lower, ymax = upper, group = month, color = month, fill = month),
#            outline.type = "full", linetype = 2, alpha = 0.1, size = 0.6) +
geom_line(data = modeled_df %>% filter(month %in% plotm),
aes(y = lower, group = month, color = month),
linetype = 2, size = 0.9) +
#scale_colour_viridis_d() +
scale_colour_manual(values = c("#0836C1","#3E88EF","#d62828","#f77f00")) +
scale_x_continuous(expand= c(0,0), limits = c(0, NA)) +
#labs(title = loc$site[1],
#    color ='Month')+
theme(text = element_text(colour = 'black',size = 13),
strip.text = element_text(colour = 'black',size = 13),
axis.ticks.length=unit(0.3, "lines"),
panel.border = element_rect(fill = NA, color = "black"),
#  legend.position="none",
axis.title = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
modeled_df$month <- as.factor(modeled_df$month)
p <- ggplot(data= modeled_df %>% filter(month %in% plotm),
aes(x = year, y = modGI)) +
geom_line(aes(group = month, color = month), size = 0.6) +
#geom_ribbon(data = modeled_df %>% filter(month %in% plotm),
#            aes(ymin = lower, ymax = upper, group = month, color = month, fill = month),
#            outline.type = "full", linetype = 2, alpha = 0.1, size = 0.6) +
geom_line(data = modeled_df %>% filter(month %in% plotm),
aes(y = lower, group = month, color = month),
linetype = 2, size = 0.9) +
#scale_colour_viridis_d() +
scale_colour_manual(values = c("#0836C1","#3E88EF","#d62828","#f77f00")) +
scale_x_continuous(expand= c(0,0), limits = c(0, NA)) +
#labs(title = loc$site[1],
#    color ='Month')+
theme(text = element_text(colour = 'black',size = 13),
strip.text = element_text(colour = 'black',size = 13),
axis.ticks.length=unit(0.3, "lines"),
panel.border = element_rect(fill = NA, color = "black"),
#  legend.position="none",
axis.title = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank())
p
